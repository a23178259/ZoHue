<nav class="navbar navbar-sticky navbar-expand-lg navbar-light bg-light border-bottom border-natural-300 py-3">
    <div class="container d-flex align-items-center">
        <!-- Logo -->
        <a class="navbar-brand logo-picture" href="index.html">
            <img src="../assets/images/logo.svg" alt="logo">
        </a>

        <!-- 手機版登入按鈕 -->
        <a href="#" class="d-lg-none ms-auto me-2">
            <button class="btn btn-secondaryL fw-semibold btn-mobile">登入/註冊</button>
        </a>

        <!-- 漢堡選單  -->
        <button class="navbar-toggler border-0 d-lg-none" type="button" onclick="toggleMobileDropdown()">
            <i id="hamburgerIcon" class="fa-solid fa-bars text-natural-700 hamburger-icon"></i>
        </button>

        <!-- 桌面版菜單 -->
        <div class="collapse navbar-collapse navbarList" id="navbarSupportedContent">
            <ul class="navbar-nav ms-auto mb-2 mb-lg-0 align-items-center">
                <li class="nav-item">
                    <a class="navbarList-link nav-link px-3 text-natural-950 text-decoration-none link-primary"
                        href="#">專案探索</a>
                </li>
                <li class="nav-item">
                    <a class="navbarList-link nav-link px-3 text-natural-950 text-decoration-none link-primary"
                        href="#">關於我們</a>
                </li>
                <li class="nav-item">
                    <a class="navbarList-link nav-link px-3 text-natural-950 text-decoration-none link-primary" href="#"
                        onclick="openLightbox()">志工故事</a>
                </li>
                <li class="nav-item">
                    <a class="navbarList-link nav-link px-3 text-natural-950 text-decoration-none link-primary"
                        href="#">常見問題</a>
                </li>
                <!-- 桌面版登入按鈕 -->
                <li class="nav-item d-none d-lg-block ms-5">
                    <a href="#">
                        <button class="btn btn-secondaryL fw-semibold">登入/註冊</button>
                    </a>
                </li>
            </ul>
        </div>
    </div>
</nav>

<!-- 手機版下拉菜單  -->
<div class="mobile-dropdown-menu d-lg-none" id="mobileDropdown">
    <ul class="mobile-menu-links pb-4 text-center">
        <li><a href="#" class="text-natural-950 text-decoration-none link-primary"
                onclick="closeMobileDropdown()">專案探索</a></li>
        <li><a href="#" class="text-natural-950 text-decoration-none link-primary"
                onclick="closeMobileDropdown()">關於我們</a></li>
        <li><a href="#" class="text-natural-950 text-decoration-none link-primary"
                onclick="closeMobileDropdown(); openLightbox()">志工故事</a></li>
        <li><a href="#" class="text-natural-950 text-decoration-none link-primary"
                onclick="closeMobileDropdown()">常見問題</a></li>
    </ul>

    <div class="mobile-menu-footer py-4 px-5 mx-3">
        <button class="btn btn-secondaryL fw-semibold rounded-pill" onclick="closeMobileDropdown()">登入/註冊</button>
    </div>
</div>

<%- include('volunteerStories') %>

    <script>
        // 計算滾動條寬度
        function getScrollbarWidth() {
            // 創建一個臨時元素來測量滾動條寬度
            const outer = document.createElement('div');
            outer.style.visibility = 'hidden';
            outer.style.overflow = 'scroll';
            outer.style.msOverflowStyle = 'scrollbar';
            document.body.appendChild(outer);

            const inner = document.createElement('div');
            outer.appendChild(inner);

            const scrollbarWidth = (outer.offsetWidth - inner.offsetWidth);
            outer.parentNode.removeChild(outer);

            return scrollbarWidth;
        }

        // 設置滾動條寬度 CSS 變量
        function setScrollbarWidth() {
            const scrollbarWidth = getScrollbarWidth();
            document.documentElement.style.setProperty('--scrollbar-width', `${scrollbarWidth}px`);
        }

        // 頁面載入時設置滾動條寬度
        document.addEventListener('DOMContentLoaded', function () {
            setScrollbarWidth();
        });

        function toggleMobileDropdown() {
            const dropdown = document.querySelector('#mobileDropdown');
            const icon = document.querySelector('#hamburgerIcon');
            const body = document.body;

            dropdown.classList.toggle('show');

            // 切換圖標和動畫
            if (dropdown.classList.contains('show')) {
                // 菜單打開 - 變成 X
                icon.className = 'fa-solid fa-xmark text-natural-700 hamburger-icon active';
                // 隱藏滾動條
                body.classList.add('mobile-menu-open');
            } else {
                // 菜單關閉 - 變回漢堡包
                icon.className = 'fa-solid fa-bars text-natural-700 hamburger-icon';
                // 顯示滾動條
                body.classList.remove('mobile-menu-open');
            }
        }

        function closeMobileDropdown() {
            const dropdown = document.querySelector('#mobileDropdown');
            const icon = document.querySelector('#hamburgerIcon');
            const body = document.body;

            dropdown.classList.remove('show');
            // 重置圖標為漢堡包
            icon.className = 'fa-solid fa-bars text-natural-700 hamburger-icon';
            // 顯示滾動條
            body.classList.remove('mobile-menu-open');
        }

        // 點擊頁面其他地方關閉菜單
        document.addEventListener('click', function (event) {
            const dropdown = document.querySelector('#mobileDropdown');
            const toggleButton = document.querySelector('.navbar-toggler');

            if (!dropdown.contains(event.target) && !toggleButton.contains(event.target)) {
                if (dropdown.classList.contains('show')) {
                    closeMobileDropdown();
                }
            }
        });

        // 處理視窗大小變化
        window.addEventListener('resize', function () {
            // 如果變回桌面版，確保移除 mobile-menu-open class
            if (window.innerWidth >= 992) {
                document.body.classList.remove('mobile-menu-open');
            }
            // 重新計算滾動條寬度
            setScrollbarWidth();
        });
    </script>