<section class="success-cases-wapper py-7 bg-bg-01">
    <div class="success-cases-container">
        <!-- 標題圖片 -->
        <div class="success-image">
            <img src="../assets/images/Variant4.svg" alt="成功專案實績" class="success-img">
            <img src="../assets/images/Variant04.svg" alt="獎盃圖標" class="successSmall-image">
        </div>
        <!-- 成功案例卡片 -->
        <div class="success-cases-cardsbox">
            <!-- 卡片 1: 平面設計師 -->
            <div class="success-cases-card">
                <div class="success-cases-card-inner">
                    <div class="success-cases-job-title text-primary-700">提案者：平面設計 × 陳志明 老師</div>
                    <div class="card-headerImgArea">
                        <img src="../assets/images/successImg1.svg" alt="successImg1" class="card-headerImg">
                    </div>

                    <div class="success-cases-card-body my-5">
                        <h4 class="success-cases-name natural-950 fw-semibold">陪伴學生完成第一份設計作品</h4>
                        <div class="success-cases-skill-tags">
                            <a href="#"
                                class="success-cases-skill-tag text-secondary-800 bg-secondary-50 py-1 px-2 border border-secondary-500 small">
                                <span>UIUX設計</span>
                            </a>
                            <a href="#"
                                class="success-cases-skill-tag text-secondary-800 bg-secondary-50 py-1 px-2 border border-secondary-500 small">
                                <span>網頁設計</span>
                            </a>
                            <a href="#"
                                class="success-cases-skill-tag text-secondary-800 bg-secondary-50 py-1 px-2 border border-secondary-500 small">
                                <span>介面設計</span>
                            </a>
                        </div>
                        <div class="success-cases-bio text-natural-700">
                            這次有志工手把手教學，協助經濟弱勢學生從零學會Adobe平面設計，結合實務專案讓幫他們建立作品集，後來有幾位真的順利接案了，超感動！
                        </div>
                    </div>
                    <div class="border-top border-natural-300 mx-xxl mb-5"></div>
                    <div class="success-cases-card-footer">
                        <div class="success-cases-stats">
                            <div class="success-cases-stat">
                                <h5 class="fs-lg text-secondary-700 fw-semibold">3位</h5>
                                <span class="small text-natural-700">技能志工數</span>
                            </div>
                            <div class="success-cases-stat">
                                <h5 class="fs-lg text-secondary-700 fw-semibold">12位</h5>
                                <span class="small text-natural-700">學員人數</span>
                            </div>
                            <div class="success-cases-stat">
                                <h5 class="fs-lg text-secondary-700 fw-semibold">32H</h5>
                                <span class="small text-natural-700">教學時數</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- 卡片 2: 程式設計師 -->
            <div class="success-cases-card">
                <div class="success-cases-card-inner">
                    <div class="success-cases-job-title text-primary-700">提案者：前端開發 × 李美華 老師</div>
                    <div class="card-headerImgArea">
                        <img src="../assets/images/successImg2.svg" alt="successImg2" class="card-headerImg">
                    </div>
                    <div class="success-cases-card-body my-5">
                        <h4 class="success-cases-name natural-950 fw-semibold">帶領學員踏入程式開發領域</h4>
                        <div class="success-cases-skill-tags">
                            <a href="#"
                                class="success-cases-skill-tag text-secondary-800 bg-secondary-50 py-1 px-2 border border-secondary-500 small">
                                <span>React開發</span>
                            </a>
                            <a href="#"
                                class="success-cases-skill-tag text-secondary-800 bg-secondary-50 py-1 px-2 border border-secondary-500 small">
                                <span>JavaScript</span>
                            </a>
                            <a href="#"
                                class="success-cases-skill-tag text-secondary-800 bg-secondary-50 py-1 px-2 border border-secondary-500 small">
                                <span>前端架構</span>
                            </a>
                        </div>
                        <div class="success-cases-bio text-natural-700">
                            我自己也是從零基礎轉職工程師的，深知這條路不容易。
                            所以想幫助更多人跨入程式領域，提案開設前端課程。
                            用最實務的方式教學，每個學員都要完成自己的網站專案。
                        </div>
                    </div>
                    <div class="border-top border-natural-300 mx-xxl mb-5"></div>
                    <div class="success-cases-card-footer">
                        <div class="success-cases-stats">
                            <div class="success-cases-stat">
                                <h5 class="fs-lg text-secondary-700 fw-semibold">5位</h5>
                                <span class="small text-natural-700">技能志工數</span>
                            </div>
                            <div class="success-cases-stat">
                                <h5 class="fs-lg text-secondary-700 fw-semibold">92%</h5>
                                <span class="small text-natural-700">學員轉職率</span>
                            </div>
                            <div class="success-cases-stat">
                                <h5 class="fs-lg text-secondary-700 fw-semibold">48H</h5>
                                <span class="small text-natural-700">教學時數</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- 卡片 3: 數位行銷 -->
            <div class="success-cases-card">
                <div class="success-cases-card-inner">
                    <div class="success-cases-job-title text-primary-700">提案者：數位行銷 × 王建國 老師</div>
                    <div class="card-headerImgArea">
                        <img src="../assets/images/successImg3.svg" alt="successImg3" class="card-headerImg">
                    </div>
                    <div class="success-cases-card-body my-5">
                        <h4 class="success-cases-name natural-950 fw-semibold">協助餐飲店學會數位行銷</h4>
                        <div class="success-cases-skill-tags">
                            <a href="#"
                                class="success-cases-skill-tag text-secondary-800 bg-secondary-50 py-1 px-2 border border-secondary-500 small">
                                <span>Google Ads</span>
                            </a>
                            <a href="#"
                                class="success-cases-skill-tag text-secondary-800 bg-secondary-50 py-1 px-2 border border-secondary-500 small">
                                <span>Facebook廣告</span>
                            </a>
                            <a href="#"
                                class="success-cases-skill-tag text-secondary-800 bg-secondary-50 py-1 px-2 border border-secondary-500 small">
                                <span>社群經營</span>
                            </a>
                        </div>
                        <div class="success-cases-bio text-natural-700">
                            現在是數位時代，但很多小店家不懂網路行銷，所以我提案教大家數位行銷技能。
                            從基礎的Facebook廣告到Google Ads，讓大家能為自己的事業打拼。
                            有學員學會後幫家裡的小吃店做行銷，業績成長三倍，超有成就感！
                        </div>
                    </div>
                    <div class="border-top border-natural-300 mx-xxl mb-5"></div>
                    <div class="success-cases-card-footer">
                        <div class="success-cases-stats">
                            <div class="success-cases-stat">
                                <h5 class="fs-lg text-secondary-700 fw-semibold">4位</h5>
                                <span class="small text-natural-700">技能志工數</span>
                            </div>
                            <div class="success-cases-stat">
                                <h5 class="fs-lg text-secondary-700 fw-semibold">15位</h5>
                                <span class="small text-natural-700">學員人數</span>
                            </div>
                            <div class="success-cases-stat">
                                <h5 class="fs-lg text-secondary-700 fw-semibold">56H</h5>
                                <span class="small text-natural-700">教學時數</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- 卡片 4: 餐飲技能 -->
            <div class="success-cases-card">
                <div class="success-cases-card-inner">
                    <div class="success-cases-job-title text-primary-700">提案者：烘焙主廚 × 張雅芳 老師</div>
                    <div class="card-headerImgArea">
                        <img src="../assets/images/successImg4.svg" alt="successImg4" class="card-headerImg">
                    </div>
                    <div class="success-cases-card-body my-5">
                        <h4 class="success-cases-name natural-950 fw-semibold">培養烘焙人才成功創業</h4>
                        <div class="success-cases-skill-tags">
                            <a href="#"
                                class="success-cases-skill-tag text-secondary-800 bg-secondary-50 py-1 px-2 border border-secondary-500 small">
                                <span>烘焙技術</span>
                            </a>
                            <a href="#"
                                class="success-cases-skill-tag text-secondary-800 bg-secondary-50 py-1 px-2 border border-secondary-500 small">
                                <span>食品安全</span>
                            </a>
                            <a href="#"
                                class="success-cases-skill-tag text-secondary-800 bg-secondary-50 py-1 px-2 border border-secondary-500 small">
                                <span>創業輔導</span>
                            </a>
                        </div>
                        <div class="success-cases-bio text-natural-700">
                            烘焙是我的專業也是熱情，希望能傳授這項技能幫助更多人自立。
                            我提案開設烘焙創業班，除了教技術還包括成本控制、店面經營。
                            最開心的是有三位學員現在都開了自己的烘焙坊，每次經過都會進去買個麵包聊聊近況！
                        </div>
                    </div>
                    <div class="border-top border-natural-300 mx-xxl mb-5"></div>
                    <div class="success-cases-card-footer">
                        <div class="success-cases-stats">
                            <div class="success-cases-stat">
                                <h5 class="fs-lg text-secondary-700 fw-semibold">6位</h5>
                                <span class="small text-natural-700">技能志工數</span>
                            </div>
                            <div class="success-cases-stat">
                                <h5 class="fs-lg text-secondary-700 fw-semibold">65%</h5>
                                <span class="small text-natural-700">創業率</span>
                            </div>
                            <div class="success-cases-stat">
                                <h5 class="fs-lg text-secondary-700 fw-semibold">100H</h5>
                                <span class="small text-natural-700">教學時數</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- 卡片 5: 美容美髮 -->
            <div class="success-cases-card">
                <div class="success-cases-card-inner">
                    <div class="success-cases-job-title text-primary-700">提案者：美髮設計師 × 林慧君 老師</div>
                    <div class="card-headerImgArea">
                        <img src="../assets/images/successImg5.svg" alt="successImg5" class="card-headerImg">
                    </div>
                    <div class="success-cases-card-body my-5">
                        <h4 class="success-cases-name natural-950 fw-semibold">免費教學助人一技之長</h4>
                        <div class="success-cases-skill-tags">
                            <a href="#"
                                class="success-cases-skill-tag text-secondary-800 bg-secondary-50 py-1 px-2 border border-secondary-500 small">
                                <span>美髮設計</span>
                            </a>
                            <a href="#"
                                class="success-cases-skill-tag text-secondary-800 bg-secondary-50 py-1 px-2 border border-secondary-500 small">
                                <span>技能檢定</span>
                            </a>
                            <a href="#"
                                class="success-cases-skill-tag text-secondary-800 bg-secondary-50 py-1 px-2 border border-secondary-500 small">
                                <span>證照輔導</span>
                            </a>
                        </div>
                        <div class="success-cases-bio text-natural-700">
                            美髮是一技之長，可以讓人有穩定收入和自信。
                            我看到許多人想學但負擔不起學費，所以提案免費教學。
                            從基礎剪髮到考取證照，全程陪伴。
                            現在有位學員在知名沙龍當設計師，她說這個課程改變了她的人生！
                        </div>
                    </div>
                    <div class="border-top border-natural-300 mx-xxl mb-5"></div>
                    <div class="success-cases-card-footer">
                        <div class="success-cases-stats">
                            <div class="success-cases-stat">
                                <h5 class="fs-lg text-secondary-700 fw-semibold">5位</h5>
                                <span class="small text-natural-700">技能志工數</span>
                            </div>
                            <div class="success-cases-stat">
                                <h5 class="fs-lg text-secondary-700 fw-semibold">75%</h5>
                                <span class="small text-natural-700">考照率</span>
                            </div>
                            <div class="success-cases-stat">
                                <h5 class="fs-lg text-secondary-700 fw-semibold">120H</h5>
                                <span class="small text-natural-700">教學時數</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- 卡片 6: 攝影影像 -->
            <div class="success-cases-card">
                <div class="success-cases-card-inner">
                    <div class="success-cases-job-title text-primary-700">提案者：商業攝影師 × 劉宇翔 老師</div>
                    <div class="card-headerImgArea">
                        <img src="../assets/images/successImg6.svg" alt="successImg6" class="card-headerImg">
                    </div>
                    <div class="success-cases-card-body my-5">
                        <h4 class="success-cases-name natural-950 fw-semibold">分享攝影技能記錄美好</h4>
                        <div class="success-cases-skill-tags">
                            <a href="#"
                                class="success-cases-skill-tag text-secondary-800 bg-secondary-50 py-1 px-2 border border-secondary-500 small">
                                <span>商業攝影</span>
                            </a>
                            <a href="#"
                                class="success-cases-skill-tag text-secondary-800 bg-secondary-50 py-1 px-2 border border-secondary-500 small">
                                <span>影像剪輯</span>
                            </a>
                            <a href="#"
                                class="success-cases-skill-tag text-secondary-800 bg-secondary-50 py-1 px-2 border border-secondary-500 small">
                                <span>後製技術</span>
                            </a>
                        </div>
                        <div class="success-cases-bio text-natural-700">
                            攝影讓我記錄了許多美好時刻，也想讓更多人擁有這項技能。
                            我提案開設攝影課程，從相機操作到後製修圖，培養大家的攝影眼。
                            有學員現在專門拍婚禮，他說每次看到新人滿意的笑容，就想起當初學攝影的初衷！
                        </div>
                    </div>
                    <div class="border-top border-natural-300 mx-xxl mb-5"></div>
                    <div class="success-cases-card-footer">
                        <div class="success-cases-stats">
                            <div class="success-cases-stat">
                                <h5 class="fs-lg text-secondary-700 fw-semibold">3位</h5>
                                <span class="small text-natural-700">技能志工數</span>
                            </div>
                            <div class="success-cases-stat">
                                <h5 class="fs-lg text-secondary-700 fw-semibold">10位</h5>
                                <span class="small text-natural-700">學員人數</span>
                            </div>
                            <div class="success-cases-stat">
                                <h5 class="fs-lg text-secondary-700 fw-semibold">48H</h5>
                                <span class="small text-natural-700">教學時數</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>



<script src="https://cdn.jsdelivr.net/npm/gsap@3.13.0/dist/gsap.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/gsap@3.13.0/dist/ScrollTrigger.min.js"></script>

<script>
    const successScrollbox = {
        wapper: document.querySelector(".success-cases-wapper"),
        cardsbox: document.querySelector(".success-cases-cardsbox"),
        distance: 0,
        if_leave: false,
        scrollTriggerInstance: null,

        init() {
            this.resize();
            window.addEventListener("resize", this.resize.bind(this));
            // 延遲初始化，確保頁面滾動位置穩定
            setTimeout(() => {
                this.create_scrolltrigger();
                this.checkInitialState();
            }, 100);
        },

        checkInitialState() {
            // 檢查當前滾動位置是否已經超過觸發區域
            const navbar = document.querySelector('.navbar');
            const headerHeight = navbar ? navbar.offsetHeight : 80;
            const currentScrollY = window.scrollY;
            const triggerStart = this.wapper.offsetTop - headerHeight;
            const triggerEnd = this.wapper.offsetTop + this.wapper.offsetHeight;

            // 如果當前滾動位置超過了觸發區域的結束點
            if (currentScrollY >= triggerEnd) {
                this.if_leave = true;
                this.cardsbox.style.transform = `translateX(-${this.distance}px)`;
            }
            // 如果在觸發區域內，計算正確的進度
            else if (currentScrollY >= triggerStart && currentScrollY <= triggerEnd) {
                const progress = (currentScrollY - triggerStart) / (triggerEnd - triggerStart);
                this.cardsbox.style.transform = `translateX(-${progress * this.distance}px)`;
                this.if_leave = false;
            }
            // 如果在觸發區域之前
            else {
                this.cardsbox.style.transform = `translateX(0px)`;
                this.if_leave = false;
            }
        },

        create_scrolltrigger() {
            // 如果已經存在 ScrollTrigger 實例，先銷毀它
            if (this.scrollTriggerInstance) {
                this.scrollTriggerInstance.kill();
            }

            // 計算 header 的高度
            const navbar = document.querySelector('.navbar');
            const headerHeight = navbar ? navbar.offsetHeight : 80;

            this.scrollTriggerInstance = ScrollTrigger.create({
                trigger: this.wapper,
                start: `top ${headerHeight}px`,
                end: "bottom bottom",
                onUpdate: (self) => {
                    this.cardsbox.style.transform = `translateX(-${self.progress * this.distance}px)`;
                },
                onLeave: () => {
                    this.if_leave = true;
                    console.log('ScrollTrigger onLeave:', this.if_leave);
                },
                onEnterBack: () => {
                    this.if_leave = false;
                    console.log('ScrollTrigger onEnterBack:', this.if_leave);
                },
                onEnter: () => {
                    this.if_leave = false;
                    console.log('ScrollTrigger onEnter:', this.if_leave);
                },
                onLeaveBack: () => {
                    this.if_leave = false;
                    console.log('ScrollTrigger onLeaveBack:', this.if_leave);
                }
            });
        },

        resize() {
            this.distance = this.cardsbox.offsetWidth - innerWidth;
            this.wapper.style.height = `${this.distance}px`;

            // 重新計算後，需要重新檢查狀態
            if (this.scrollTriggerInstance) {
                setTimeout(() => {
                    this.checkInitialState();
                }, 10);
            }
        }
    };

    // 確保DOM載入完成且滾動位置穩定後再初始化
    function initializeWhenReady() {
        // 等待頁面載入和滾動位置穩定
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', () => {
                setTimeout(() => successScrollbox.init(), 300);
            });
        } else {
            setTimeout(() => successScrollbox.init(), 300);
        }
    }

    // 監聽頁面顯示事件（處理前進/後退按鈕的情況）
    window.addEventListener('pageshow', function (event) {
        if (event.persisted) {
            // 頁面從緩存中恢復，重新初始化
            setTimeout(() => {
                if (successScrollbox.scrollTriggerInstance) {
                    successScrollbox.scrollTriggerInstance.kill();
                }
                successScrollbox.init();
            }, 100);
        }
    });

    initializeWhenReady();
</script>